This folder contains scripts that were used to evaluate phasing quality by PhaseGrass

plot_phase_DH647.R visualizes the following:

1 chromosomes of Kyuss, the reference
2 distribution of gaps, 
3 distribution of snps phased by Hi-C,
4 compare phase generated by PhaseGrass with Kyuss phase
5 the chromosome-level phase blocks with SNP density
6 the small phase blocks with SNP density
7 distribution of SNPs called from whole chromosome alignment between haplomes generated by PhaseGrass and Kyuss  

Input data for 1 and 2 were obtained from Kyuss v2.0 publication

Input data for 3 were generated with check_hic_SNP.R. This R scripts takes the input generated by get_largest_phase_block.sh. get_largest_phase_block.sh takes the phased VCF genreated by HapCUT2 with Hi-C data.

Input data for 4 were genreated with check_phase_with_snp_density.R. 
This R script takes the phased SNPs extracted by get_phase.sh from the phased VCF genrated by WhatsHap and calculates the ratio of non-Kyuss allele per 1 Mb window.

Input data for 5 and 6 were generated with DH647_phase_block_new.R. This R script takes the phase block list generatd by WhatsHap and the phased SNPs (in the chromosome-level and small phase blocks separately) as input. 
The phased SNPs with their associated phase blocks were extracted from the phased VCF genreated by WhatsHap using get_phase_block.sh  

Input data for 7 were prepared with check_phase_chr_alignment_heatmap.R. One input file of this R script was generated using get_phase.sh with the phased VCF from WhatsHap. 
Another two input file for check_phase_chr_alignment_heatmap.R were from SNP_call_WGA_DH647, the whole chromosome alignment between haplomes and kyuss.


